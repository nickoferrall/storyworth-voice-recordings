# Fitlo - Cursor AI Instructions

## Project Overview

Fitlo is software that helps gyms organize fitness competitions like Hyrox Simulations and CrossFit. Similar to Competition Corner and Team Aretas.

## Key Architecture & Rules

### GraphQL & Nexus

- We use GraphQL with Nexus for the backend API
- Create mutations by:
  1. Adding server-side mutation in `graphql/mutations/`
  2. Adding corresponding `.graphql` file in `graphql/operations/`
- Never add code comments unless explicitly requested

### Database & Types

- **Main Migration**: We're consolidating `DirectoryComp` and `Competition` types into a single `Competition` type
- `DirectoryComp` will eventually be redundant
- Use `source` field to distinguish: `'USER_CREATED'` vs `'SCRAPED_ARETAS'` vs `'SCRAPED_COMP_CORNER'`
- Database uses Kysely for type-safe queries
- Supabase for hosted database

### Scrapers

- Located in `/scrapers/` directory
- Current focus: migrating Aretas scraper to create `Competition` records instead of `DirectoryComp`
- Use OpenAI for intelligent country detection when location data is ambiguous
- Price ranges: Show `£50-£100` style ranges instead of single prices for scraped competitions

### Frontend (Next.js + React)

- **UI Framework**: Tailwind CSS + Shadcn/ui components
- **Current focus**: Explore page redesign inspired by Luma's clean aesthetic
- **Theme**: Dark cards with white text, minimal design
- **Cards**: Horizontal layout with square images on right (24x24), no purple hover effects
- Use `OptimizedImage` component for images

### File Editing Preferences

- Use `edit_file` for files < 2500 lines
- Use `search_replace` for larger files
- Always run multiple tool calls in parallel when possible
- Never create documentation files unless explicitly requested

### Environment

- **CRITICAL**: Uses `.env.prod` for production database connection locally
- **NEVER** run database resets - we're connected to live production data
- **NEVER** run migrations (`db:push`, `supabase db push`, etc.) - user handles all migrations
- All scraper data goes directly to production database
- Database connection via Supabase

## Current Priorities

1. **Explore Page Migration**: Move from `DirectoryComp` to `Competition` queries
2. **Scraper Enhancement**: Better country detection, price ranges, database integration
3. **UI Polish**: Clean, Luma-inspired card design

## Common Patterns

- Authentication via `withAuth` utility
- Data loading with Apollo Client and data loaders
- Error boundaries and graceful fallbacks
- Session storage for UI state persistence

## Do NOT

- Add comments to code
- Create README or documentation files unprompted
- Reset production database
- Use `DirectoryComp` in new features (migrate to `Competition`)

## Dependencies

- Next.js, React, TypeScript
- Apollo Client + GraphQL
- Tailwind CSS + Shadcn/ui
- Kysely + Supabase
- Puppeteer for scraping
- OpenAI for AI-powered data enhancement
